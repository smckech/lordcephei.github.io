<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>LM Suite - Zeeman Field Tutorial</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content=""/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="LM Suite - Zeeman Field Tutorial" /> <meta property="og:description" content="»LM Suite« is a program for for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//extbfield/" /> <meta property="og:site_name" content="LM Suite" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="show-for-small-only"><a href="https://lordcephei.github.io" class="icon-tree"> LM Suite</a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="right"> <script language="Javascript" type="text/javascript"> function google_search() { var query = document.getElementById("google-search").value; window.open("http://google.com/search?q=" + query + "%20site:" + "https://lordcephei.github.io"); } </script> <li class="divider"></li> <li style="background:#FFFFFF"> <form style="width:200px" onsubmit="google_search()" > <input type="text" id="google-search" placeholder="Enter search term and hit enter"> </form> </li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> </ul> <ul class="left"> <li><a href="https://lordcephei.github.io/">Start</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/blog/">News and Updates</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io/docs/">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/insert/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/install/">Installation</a></li> <li><a href="https://lordcephei.github.io/fplmtoverview/">FP Overview</a></li> <li><a href="https://lordcephei.github.io/fpcapabilities/">FP Capabilities</a></li> <li><a href="https://lordcephei.github.io/inputguide/">The Input File</a></li> <li><a href="https://lordcephei.github.io/opticsdoc/">Optics</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/lmtut/">Basic GW Tutorial</a></li> <li><a href="https://lordcephei.github.io/asadoc/">ASA tutorial</a></li> <li><a href="https://lordcephei.github.io/buildingfpinput/">Building the FP Input File</a></li> <li><a href="https://lordcephei.github.io/fpnew/">Tutorial for the full-potential LDA program lmf</a></li> <li><a href="https://lordcephei.github.io/fpoptbas/">FP basis optimisation</a></li> <li><a href="https://lordcephei.github.io/extbfield/">Adding external Zeeman field to the potential</a></li> <li><a href="https://lordcephei.github.io/fstut/">Generating a Fermi surface in spin polarized Fe</a></li> </ul> </li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> <li class="divider"></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <p class="subheadline"></p> <h1>LM Suite - Zeeman Field Tutorial</h1> </header> <p class="teaser"> </p> <h1 id="adding-external-zeeman-field-to-potential-v703"><strong>Adding external Zeeman field to potential (v7.03)</strong></h1> <hr /> <p>Note: this page has not been carefully worked out, especially the description of the Stoner parameter may not be accurate.</p> <p>You can add to the crystal potential an external magnetic field inside each augemetation sphere, in the ASA program <strong>lm</strong> and full-potential program <strong>lmf</strong>. Use token BFIELD to tell <strong>lm</strong> or <strong>lmf</strong> that a field is to be read. The calculation must be spin polarized, e.g.</p><pre><code>HAM    NSPIN=2 BFIELD=2
...
</code></pre><p><em style="color: green">BFIELD=1</em> allows the field to point in any direction; <em style="color: green">BFIELD=2</em> restricts the field to the <em>z</em> axis. The former case generates a noncollinear hamiltonian; the latter is spin diagonal. (The hamiltonian may also be noncollinear for another reason, e.g. spin-orbit coupling is turned on.) <br /> Caution: <strong>lmf</strong> does not as yet generate noncollinear output densities. Self-consistent calculations with noncollinear <strong>B</strong> fields are not possible; also the total energy is not trustworthy if <strong>B</strong> is not along the <em>z</em> axis.</p> <p>By selecting BFIELD nonzero, you are telling <strong>lm</strong> or <strong>lmf</strong> that a (site-dependent) Zeeman field is to be added. In this case you must also supply a site-dependent external field, which you do through the additional file bfield.ext. If this file is omitted, the program will not execute. bfield.ext contains one row for each site; each row contains three numbers corresponding to <em>x</em>,<em>y</em>,<em>z</em> components of <strong>B</strong>. (The file must always contain three components <em>B<sub>x</sub>.</em> <em>B<sub>y</sub></em> <em>B<sub>z</sub></em> even if <em style="color: green">BFIELD=2</em>.) <br /> The GdN test case (part of the test suite) is an instructive example. In the top-level directory, run this test:</p><pre><code>fp/test/test.fp gdn
</code></pre><p>This test combines the LDA+<em>U</em> hamiltonian with spin-orbit coupling. Bands are calculated for that case; then a magnetic field of 0.25 eV=0.037/2 Ry is added to the Gd site and the bands are recalculated. GdN has two atoms and file <em style="color: blue">bfield.gdn</em> reads:</p><pre><code>0 0 .037/2
0 0 0
</code></pre><p>The test generates files <em style="color: blue">bnds.bfield.gdn</em> and <em style="color: blue">bnds.nobfield.gdn</em> To analyze the bands you need to use a graphics package. If you have the FPLOT packaged installed, you can draw the picture shown below comparing the two cases, by invoking the following commands after running the test:</p><pre><code>echo -8,8,5,10 | plbnds -fplot -ef=0 -scl=13.6 -lbl=L,G,X,W,G -dat=blue bnds.nobfield.gdn
echo -8,8,5,10 | plbnds -fplot -ef=0 -scl=13.6 -lbl=L,G,X,W,G -dat=dat  bnds.bfield.gdn
mv plot.plbnds plot.plbnds~
echo "% char0 colr=3,bold=4,clip=1,col=1,.2,.3" &gt;&gt;plot.plbnds
echo "% char0 colb=2,bold=2,clip=1,col=.2,.3,1" &gt;&gt;plot.plbnds
awk '{if ($1 == "-colsy") {sub("-qr","-lt {colr} -qr");print;sub("dat","blue");sub("colr","colb");print} else {print}}' plot.plbnds~ &gt;&gt;plot.plbnds
fplot -disp -f plot.plbnds
</code></pre><p><strong><a href="http://lordcephei.github.io/images/graph1.png">Click here for image</a></strong></p> <p>In the figure, blue bands are LDA+<em>U</em> results. Because spin-orbit coupling is included both minority and majority spin bands appear. You can see majority Gd <em>f</em> states near -6.5 eV, and minority <em>f</em> states near +5.5 eV. Gd <em>d</em> states are spin-split by the exchange-correlation field originating from spin splitting of the Gd <em>f</em> states; majority and minority <em>d</em> states are found near 2.5 eV and 3.5 eV, respectively, at the Γ point.</p> <p>Red bands use the same potential as the LDA+<em>U</em> case, except that a <em>B<sub>z</sub></em> field of magnitude 0.5 eV was added to the Gd site. <em>B<sub>z</sub></em> causes the the following shifts:</p> <ul> <li>The majority <em>f</em> shifts <em>down</em> by ~0.22 eV, and the minority <em>f</em> states shift <em>up</em> by ~0.27 eV. States that are purely atomic like and are little affected by the kinetic energy will be shifted by the Zeeman field, ±<em>B</em>/2. This is the case for Gd <em>f</em> orbitals.</li> <li>The majority <em>d</em> states at Γ shift <em>down</em> by ~0.16 eV; the minority <em>d</em> states shift <em>up</em> by ~0.20 eV.</li> <li>The As <em>p</em> states, in the (-4,0) eV range, are only slightly shifted.</li> </ul> <h3 id="longitudinal-susceptibility"><em>Longitudinal susceptibility</em></h3> <hr /> <p>The magnetic susceptibility is the system’s magnetic response to an external magnetic field:</p> <script type="math/tex; mode=display">\delta M = \chi \delta B</script> <p>or</p> <script type="math/tex; mode=display">\delta B = \chi ^{- 1} \delta M</script> <p>δM itself can be obtained from a derivative of the total energy:</p> <script type="math/tex; mode=display">\delta M = {\delta E\over \delta B} \delta B</script> <p>Thus</p> <script type="math/tex; mode=display">\chi = { \delta ^ 2 E\over \delta B ^ 2 }</script> <p>and</p> <script type="math/tex; mode=display">\chi ^ {-1} = { \delta ^ 2 E\over \delta M ^ 2 }</script> <p>In linear response theory, χ<sup>-1</sup> can be written as a sum of a noninteracting part and an interacting part</p> <script type="math/tex; mode=display">\chi ^ {-1} = \chi _ {0} ^ {-1} - I</script> <p>The kernel <em>I</em> is often associated with the “Stoner parameter.” It is typically about 1 eV in 3_d_ transition metals. <br /> The noninteracting part χ<sub>0</sub><sup>-1</sup> is connected with the induced magnetization of the noninteracting system, i.e.</p> <script type="math/tex; mode=display">\delta B = \chi _ {0} ^ {-1} \delta M _ {0}</script> <p>where δM<sub>0</sub> is the magnetization induced by δB without taking into account the internal potential shifts that δ_M_ cause. In the density-functional context, δM<sub>0</sub> can be obtained from an initially self-consistent potential <em>V_0, which is generated in the absence of an external field. δM<sub>0</sub> is then the change in _M</em> for the potential <em>V_0+δB. In practice this is obtained by evaluating the change in _M</em> from the change in output density of a 1-shot calculation with potential _V_0+δB.</p> <p>You can use <strong>lmf</strong> to apply a field and calculate <em>E_LDA and δ_M</em> as a function of B. By comparing self-consistent and 1-shot calculations you can in principle also obtain <em>I</em>. The example below does this in an approximate way for Fe, using input file fp/test/ctrl.felz. Note: a proper calculation of <em>I</em> would require a supercell large enough that the interactions between external <em>B</em>-fields would be sufficiently small. (<em>I</em> is a local function of <strong>r</strong> in density functional theory; thus <em>I</em> is a site-diagonal matrix.) Here we only consider a single atom cell. The interactions are not small, and <em>I</em> is underestimated. <br /> The results below were generated by this command:</p><pre><code>lmf -vnk=16 --pr31 -vrel=1 -vnit=50 -vso=0 --rs=1 -vbeta=.3 -vbf=2 -vbz=$bz -vconv=1d-6 -vconvc=1d-6 felz
</code></pre><p>bz must be set as a shell variable.</p> <p>Magnetization and total energy (relative to the B=0 case) were generated for several values of B, and ∂E/∂B was obtained from numerical differentiation of <em>E</em>.</p> <p><strong><a href="http://lordcephei.github.io/images/graph2.png">Click here for image</a></strong></p> <p>As the top figure shows, the total energy <em>E</em> has a minimum near, but not exactly at B=0. This shows that there are some slight errors in the LDA calculation (in an exact self-consistent LDA calculation <em>E</em> should be minimum at exactly B=0). <br /> <em>E</em> is smooth in the interval (−0.01, 0.01) Ry, as the figure shows. The behavior is somewhat unsmooth near B=−0.01 Ry, and is a discontinuity or near discontinuity is evident near B=0.01 Ry. That means numerical differentiation ∂E/∂B is a bit problematic, particularly outside the (−0.01,0.01) interval. Nevertheless we can perform it. In the bottom figure, <em>M</em>−<em>M</em>(B=0) and ∂E/∂B are plotted respectively as a function of B as dashed lines+circles, and a solid line. The two curves track fairly well, though ∂E/∂B is noisy; nor is <em>M</em>(B) particularly smooth.</p> <p>We can obtain χ from the slope ∂<em>E</em>/∂B. There is some uncertainty in the calculation since <em>M</em> is not particularly smooth (note in particular that (∂E/∂B)<sub>+</sub> and (∂E/∂B)<sub>−</sub> are a little different).</p> <p>We can also obtain both χ<sub>0</sub> by obtaining δM<sub>0</sub> from a 1-shot calculation. The table below shows M<sub>0</sub> and <em>M</em> for two values of B:</p> <table> <thead> <tr> <th style="text-align: center">B</th> <th style="text-align: center">M<sub>0</sub></th> <th style="text-align: center"><em>M</em></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">-0.005</td> <td style="text-align: center">-2.363587</td> <td style="text-align: center">-2.402973</td> </tr> <tr> <td style="text-align: center">0.005</td> <td style="text-align: center">-2.234213</td> <td style="text-align: center">-2.219662</td> </tr> </tbody> </table> <p>Thus we get:</p> <p><script type="math/tex">\chi _ {0} ^ {−1} = {0.01\over −2.234213−−2.363587} = 0.0773 Ry \Rightarrow \chi _ {0} = 12.9 Ry ^ {−1} = 0.95 eV.</script> <script type="math/tex">\chi ^ {−1} = {0.01 \over −2.219662−−2.402973} = 0.0546 Ry \Rightarrow \chi = 18.3 Ry ^ {−1} = 1.35 eV.</script> <script type="math/tex">I = \chi _ {0} ^ {−1} − \chi ^ {−1} = 0.0227 Ry = 0.30 eV</script></p> <p>As noted above, <em>I</em> calculated in this way only approximately corresponds to the Stoner <em>I</em>. A better calculation should produce <em>I</em> about 1 eV.</p> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> »LM Suite« is a program for for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> <li class="sitemap-link" > <a href="https://lordcephei.github.io/download/" title="Download the program">Downloads</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> <div id="subfooter"> <nav class="row"> <section id="subfooter-left" class="b30 small-12 medium-6 columns"> <ul class="inline-list"> <li>Created with &hearts; by <a style="display:inline;" href="http://phlow.de/">Phlow</a> with <a style="display:inline;" href="http://jekyllrb.com/" target="_blank">Jekyll</a> using <a style="display:inline;" href="http://phlow.github.io/feeling-responsive/">Feeling Responsive</a> </li> </ul> </section> <section id="subfooter-right" class="small-12 medium-6 columns social-icons"> <ul class="inline-list"> <li><a href="http://www.youtube.com/PhlowMedia" target="_blank" class="icon-youtube" title="Videos, Video-Anleitungen und Filme von Phlow auf YouTube"></a></li> <li><a href="http://twitter.com/phlow" target="_blank" class="icon-twitter" title="Immer das Neuste von Phlow gibt es auf Twitter"></a></li> <li><a href="http://www.facebook.com/phlow.media" target="_blank" class="icon-facebook" title="Lass uns Freunde sein!"></a></li> <li><a href="http://soundcloud.com/phlow" target="_blank" class="icon-soundcloud" title="Sounds und Downloads und mehr"></a></li> <li><a href="http://github.com/phlow" target="_blank" class="icon-github" title="Code und mehr..."></a></li> <li><a href="http://instagram.com/phlowmedia" target="_blank" class="icon-instagram" title="Bilder und Impressionen mit und ohne Filter..."></a></li> <li><a href="http://www.pinterest.com/phlowmedia/" target="_blank" class="icon-pinterest" title="Bilder, Fotos, Illustrationen, Grafiken sammeln..."></a></li> <li><a href="http://www.mixcloud.com/phlow/" target="_blank" class="icon-cloud" title="Mixe, was sonst?"></a></li> </ul> </section> </nav> </div><!-- /#subfooter --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
