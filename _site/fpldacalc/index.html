<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>LM Suite - Full Potential LDA Calculations</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content=""/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="LM Suite - Full Potential LDA Calculations" /> <meta property="og:description" content="»LM Suite« is a program for for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//fpldacalc/" /> <meta property="og:site_name" content="LM Suite" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="show-for-small-only"><a href="https://lordcephei.github.io" class="icon-tree"> LM Suite</a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="right"> <script language="Javascript" type="text/javascript"> function google_search() { var query = document.getElementById("google-search").value; window.open("http://google.com/search?q=" + query + "%20site:" + "https://lordcephei.github.io"); } </script> <li class="divider"></li> <li style="background:#FFFFFF"> <form style="width:200px" onsubmit="google_search()" > <input type="text" id="google-search" placeholder="Enter search term and hit enter"> </form> </li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> </ul> <ul class="left"> <li><a href="https://lordcephei.github.io/">Start</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/blog/">News and Updates</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io/docs/">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/install/">Installation</a></li> <li><a href="https://lordcephei.github.io/fplmtoverview/">FP Overview</a></li> <li><a href="https://lordcephei.github.io/fpcapabilities/">FP Capabilities</a></li> <li><a href="https://lordcephei.github.io/inputguide/">The Input File</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/buildingfpinput/">Building the FP Input File</a></li> <li><a href="https://lordcephei.github.io/fpnew/">Tutorial for the full-potential LDA program lmf</a></li> <li><a href="https://lordcephei.github.io/fpoptbas/">FP basis optimisation</a></li> <li><a href="https://lordcephei.github.io/extbfield/">Adding external Zeeman field to the potential</a></li> <li><a href="https://lordcephei.github.io/fstut/">Generating a Fermi surface in spin polarized Fe</a></li> <li><a href="https://lordcephei.github.io/lmtut/">LM Tutorial</a></li> <li><a href="https://lordcephei.github.io/asadoc/">ASA tutorial</a></li> </ul> </li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> <li class="divider"></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <p class="subheadline"></p> <h1>LM Suite - Full Potential LDA Calculations</h1> </header> <p class="teaser"> </p> <p>In the <a href="/fpnew/">preliminaries</a> we built a trial density with a Mattheis construction, and made a band pass with it. Now we can do a self-consistent calculation</p><pre><code>    lmf al &gt; out 
</code></pre><p>Up to the calculation of the Fermi level <a href="FPsamples/out.al.lmf#efermi">Fermi level</a> the output will be essentially the same.</p> <p>Now the <a href="FPsamples/out.al.lmf#outrho">output density</a> is generated. With the output density, the HKS energy functional can be evaluated. Also the log derivative parameters P are floated to the band centers-of-gravity. How the P’s are floated is prescribed by tokens <a href="tokens.html#SPECcat">IDMOD</a>; there is a corresponding ASA counterpart discussed in the <a href="lmto.html#section2">ASA overview</a>.</p> <p>A <a href="FPsamples/out.al.lmf#mixrho">new density</a> is constructed as follows:</p> <ul> <li> <p>The <em>output density</em> is screened using the model Lindhard function, provided the Lindhard parameter <a href="tokens.html#HAMcat">ELIND</a> is nonzero:</p> <script type="math/tex; mode=display">n_{out}^{\star} = n_{in} + \epsilon^{-1} (n_{out}-n_{in})</script> </li> <li> <p>An estimate for the self-consistent density is made by mixing n<sub>in</sub> and n<sub>out</sub>* using some <a href="tokens.html#mixing">mixing scheme</a> .* The resultant density is <a href="FPsamples/out.al.lmf#iors">saved</a> in rst.<em>ext</em>, unless you specify otherwise using <a href="Command-line-options.html#section1lmf">–rs=</a>.* At the end of the iteration, the total energies are printed and checks are made whether self-consistency is achieved to tolerances specified by <a href="tokens.html#ITERcat">ITER_CONV</a> and <a href="tokens.html#ITERcat">ITER_CONVC</a>. The RMS DQ generated at the <a href="FPsamples/out.al.lmf#mixrho">mixing step</a> is the measure compared against tolerance <a href="tokens.html#ITERcat">CONVC</a>; the change in energy from one iteration to the next is tested against tolerance <a href="tokens.html#ITERcat">CONV</a>. Both tolerances must be satisfied, unless you set CONV=0 or CONVC=0 (0 tolerance tells <strong>lmf</strong> not to test that parameter). Since only one iteration has been completed <a href="FPsamples/out.al.lmf#endofiter1">so far</a>, there is no way to test the CONV, so no tests are made. <strong>lmf</strong> proceeds without checks to the second iteration; from the <a href="FPsamples/out.al.lmf#endofiter2">second iteration</a> onwards convergence checks are made.</p> <p>Because Al is rather well approximated by free electron gas, the Lindhard function is an excellent approximation to the true dielectric function, and the iterations converge rapidly to self-consistency. However, because the tolerances were set <a href="#mix">very small</a>, self-consistency is achieved only after <a href="FPsamples/out.al.lmf#endofiter6">six iterations</a>. To see how the RMS DQ evolves, do</p> <p>grep ‘RMS DQ’ out</p> <p>You should see a table like this:</p> <p>mixrho: sought 3 iter from file mixm; read 0. RMS DQ=8.57e-3 mixrho: sought 3 iter from file mixm; read 1. RMS DQ=5.48e-4 last it=8.57e-3 mixrho: sought 3 iter from file mixm; read 2. RMS DQ=1.29e-4 last it=5.48e-4 mixrho: sought 3 iter from file mixm; read 3. RMS DQ=6.44e-6 last it=1.29e-4 mixrho: sought 3 iter from file mixm; read 4. RMS DQ=4.24e-7 last it=6.44e-6 mixrho: sought 3 iter from file mixm; read 4. RMS DQ=4.97e-8 last it=4.24e-7</p> <p>The code calculates two energy functionals, the Hohenberg-Kohn and Harris-Foulkes functional. Both energies printed at the end of each iteration. The HF energy is more binding than the HK after the <a href="FPsamples/out.al.lmf#endofiter1">first iteration</a>; at <a href="FPsamples/out.al.lmf#endofiter5">self-consistency</a> they are the same. The HK energy is variational; it should approach the self-consistent value from above. Usually (but not always) the HF energy approaches it from below. Thus the difference in the two is an additional measure of deviation from self-consistency. Moniter the convergence the two with:</p> <p>grep ehf=- out</p> </li> </ul><pre><code>You should see the following table:

    h ehf=-.2923995 ehk=-.2897842
    i ehf=-.2905176 ehk=-.2903167
    i ehf=-.2904201 ehk=-.2904115
    i ehf=-.2904344 ehk=-.2904343
    i ehf=-.2904324 ehk=-.2904322
    c ehf=-.2904324 ehk=-.2904322
    

The HF and HK energy functionals are completely different; that they converge to (nearly) the same answer is a test of the validity of the implementation.

These lines are also written to the [save file](lmto.html#section5); a very convenient tool [vextract](Building_FP_input_file.html#vextract) is designed to be used with it, as can be seen when evaluating the [shear constant](#shearconstant) below.

To go back to the preliminaries click [here](/fpnew/).
</code></pre></article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> »LM Suite« is a program for for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> <li class="sitemap-link" > <a href="https://lordcephei.github.io/download/" title="Download the program">Downloads</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> <div id="subfooter"> <nav class="row"> <section id="subfooter-left" class="b30 small-12 medium-6 columns"> <ul class="inline-list"> <li>Created with &hearts; by <a style="display:inline;" href="http://phlow.de/">Phlow</a> with <a style="display:inline;" href="http://jekyllrb.com/" target="_blank">Jekyll</a> using <a style="display:inline;" href="http://phlow.github.io/feeling-responsive/">Feeling Responsive</a> </li> </ul> </section> <section id="subfooter-right" class="small-12 medium-6 columns social-icons"> <ul class="inline-list"> <li><a href="http://www.youtube.com/PhlowMedia" target="_blank" class="icon-youtube" title="Videos, Video-Anleitungen und Filme von Phlow auf YouTube"></a></li> <li><a href="http://twitter.com/phlow" target="_blank" class="icon-twitter" title="Immer das Neuste von Phlow gibt es auf Twitter"></a></li> <li><a href="http://www.facebook.com/phlow.media" target="_blank" class="icon-facebook" title="Lass uns Freunde sein!"></a></li> <li><a href="http://soundcloud.com/phlow" target="_blank" class="icon-soundcloud" title="Sounds und Downloads und mehr"></a></li> <li><a href="http://github.com/phlow" target="_blank" class="icon-github" title="Code und mehr..."></a></li> <li><a href="http://instagram.com/phlowmedia" target="_blank" class="icon-instagram" title="Bilder und Impressionen mit und ohne Filter..."></a></li> <li><a href="http://www.pinterest.com/phlowmedia/" target="_blank" class="icon-pinterest" title="Bilder, Fotos, Illustrationen, Grafiken sammeln..."></a></li> <li><a href="http://www.mixcloud.com/phlow/" target="_blank" class="icon-cloud" title="Mixe, was sonst?"></a></li> </ul> </section> </nav> </div><!-- /#subfooter --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
